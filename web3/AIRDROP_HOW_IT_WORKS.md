# –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Airdrop.sol

## üìã –û–±—â–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è

–ö–æ–Ω—Ç—Ä–∞–∫—Ç `Airdrop.sol` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Merkle Tree** (–¥–µ—Ä–µ–≤–æ –ú–µ—Ä–∫–ª–∞) –¥–ª—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–≥–æ –∏ –¥–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∞–∏—Ä–¥—Ä–æ–ø–∞ —Ç–æ–∫–µ–Ω–æ–≤.

### –ß—Ç–æ —Ç–∞–∫–æ–µ Merkle Tree?

**Merkle Tree** ‚Äî —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- ‚úÖ –•—Ä–∞–Ω–∏—Ç—å –≤–µ—Å—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π **–æ—Ñ—á–µ–π–Ω** (–Ω–µ –≤ –±–ª–æ–∫—á–µ–π–Ω–µ)
- ‚úÖ –•—Ä–∞–Ω–∏—Ç—å –≤ –±–ª–æ–∫—á–µ–π–Ω–µ —Ç–æ–ª—å–∫–æ **–æ–¥–∏–Ω —Ö–µ—à** (Merkle root)
- ‚úÖ –î–æ–∫–∞–∑—ã–≤–∞—Ç—å, —á—Ç–æ –∞–¥—Ä–µ—Å –≤ —Å–ø–∏—Å–∫–µ, –∏—Å–ø–æ–ª—å–∑—É—è **–∫–æ—Ä–æ—Ç–∫–∏–π proof** (–¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ)
- ‚úÖ –û–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å **–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å** ‚Äî –ª—é–±–æ–π –º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∞–¥—Ä–µ—Å –≤ —Å–ø–∏—Å–∫–µ

---

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. –•—Ä–∞–Ω–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ

```solidity
address public immutable owner;      // –í–ª–∞–¥–µ–ª–µ—Ü (Gnosis Safe)
address public immutable token;      // –ê–¥—Ä–µ—Å —Ç–æ–∫–µ–Ω–∞ (SavitriCoin)
bytes32 public merkleRoot;           // –ö–æ—Ä–µ–Ω—å Merkle –¥–µ—Ä–µ–≤–∞
uint256 public claimEndTime;         // –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –∫–ª–µ–π–º–∞
mapping(address => bool) public claimed; // –ö—Ç–æ —É–∂–µ –ø–æ–ª—É—á–∏–ª —Ç–æ–∫–µ–Ω—ã
```

### 2. –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- `claim()` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∫–ª–µ–π–º—è—Ç —Ç–æ–∫–µ–Ω—ã —Å–∞–º–∏
- `batchSend()` ‚Äî owner –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ–∫–µ–Ω—ã –±–∞—Ç—á–∞–º–∏ (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π Merkle)
- `batchSendDirect()` ‚Äî owner –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ–∫–µ–Ω—ã –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ Merkle
- `setMerkleRoot()` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ—Ä–Ω—è –¥–µ—Ä–µ–≤–∞
- `withdrawUnclaimed()` ‚Äî –≤—ã–≤–æ–¥ –Ω–µ–≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤

---

## üìù –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

**1.1. –°–æ–∑–¥–∞–Ω–∏–µ CSV —Ñ–∞–π–ª–∞**

```csv
address,amount
0x1234...,1000
0x5678...,2000
0x9abc...,500
```

**1.2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Merkle Tree**

```bash
node scripts/generate-merkle-tree.js data/token-balances.csv
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ß–∏—Ç–∞–µ—Ç—Å—è CSV —Ñ–∞–π–ª
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–¥—Ä–µ—Å–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è "–ª–∏—Å—Ç" (leaf): `keccak256(address + amount)`
- –°—Ç—Ä–æ–∏—Ç—Å—è Merkle Tree –∏–∑ –≤—Å–µ—Ö –ª–∏—Å—Ç—å–µ–≤
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è Merkle root (–∫–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞)
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è proof (–¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- `merkle-tree-data.json` ‚Äî –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å proofs
- `merkle-root.json` ‚Äî —Ç–æ–ª—å–∫–æ root –¥–ª—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞

**–ü—Ä–∏–º–µ—Ä:**
```json
{
  "merkleRoot": "0xabc123...",
  "totalRecipients": 1000,
  "recipients": [
    {
      "address": "0x1234...",
      "amount": "1000000000000000000000",
      "proof": ["0xdef456...", "0x789abc..."]
    }
  ]
}
```

---

### –®–∞–≥ 2: –î–µ–ø–ª–æ–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞

```javascript
const Airdrop = await ethers.getContractFactory("Airdrop");
const airdrop = await Airdrop.deploy(tokenAddress);
```

**–í–∞–∂–Ω–æ:** `owner` = –∞–¥—Ä–µ—Å, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ø–ª–æ–∏—Ç (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å Gnosis Safe)

---

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞

**3.1. –ü–µ—Ä–µ–≤–æ–¥ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç**

```javascript
await savitriCoin.transfer(airdrop.address, totalAmount);
```

**3.2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Merkle root**

```javascript
await airdrop.setMerkleRoot("0xabc123...");
```

**3.3. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è**

```javascript
const endTime = Math.floor(Date.now() / 1000) + (30 * 24 * 60 * 60); // 30 –¥–Ω–µ–π
await airdrop.setClaimEndTime(endTime);
```

---

### –®–∞–≥ 4: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

–ï—Å—Ç—å **3 —Å–ø–æ—Å–æ–±–∞** —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:

---

## üéØ –°–ø–æ—Å–æ–± 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∫–ª–µ–π–º—è—Ç —Å–∞–º–∏ (`claim()`)

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

```solidity
function claim(uint256 amount, bytes32[] calldata merkleProof) external {
    // 1. –ü—Ä–æ–≤–µ—Ä–∫–∏
    require(merkleRoot != bytes32(0), "Merkle root not set");
    require(!claimed[msg.sender], "Already claimed");
    require(claimEndTime == 0 || block.timestamp <= claimEndTime, "Claim period ended");
    
    // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ Merkle proof
    bytes32 leaf = keccak256(abi.encodePacked(msg.sender, amount));
    require(
        MerkleProof.verify(merkleProof, merkleRoot, leaf),
        "Invalid Merkle proof"
    );
    
    // 3. –û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ø–æ–ª—É—á–µ–Ω–æ
    claimed[msg.sender] = true;
    
    // 4. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–æ–∫–µ–Ω—ã
    IERC20(token).transfer(msg.sender, amount);
    
    emit Claimed(msg.sender, amount);
}
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±–µ—Ä–µ—Ç —Å–≤–æ–π `proof` –∏–∑ `merkle-tree-data.json`
2. –í—ã–∑—ã–≤–∞–µ—Ç `claim(amount, proof)`
3. –ö–æ–Ω—Ç—Ä–∞–∫—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç proof –ø—Ä–æ—Ç–∏–≤ Merkle root
4. –ï—Å–ª–∏ proof –≤–∞–ª–∏–¥–Ω—ã–π ‚Üí —Ç–æ–∫–µ–Ω—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```javascript
// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ merkle-tree-data.json
const myData = {
  address: "0x1234...",
  amount: "1000000000000000000000",
  proof: ["0xdef456...", "0x789abc..."]
};

// –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏
await airdrop.claim(
  ethers.utils.parseEther("1000"),
  myData.proof
);
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –î–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∞–º–∏ –∫–ª–µ–π–º—è—Ç)
- ‚úÖ –ù–µ—Ç –≥–∞–∑–∞ –¥–ª—è owner
- ‚úÖ –ü—Ä–æ–∑—Ä–∞—á–Ω–æ (–≤—Å–µ –≤–∏–¥—è—Ç Merkle root)

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–ª–∞—Ç—è—Ç –≥–∞–∑
- ‚ö†Ô∏è –ù—É–∂–Ω–æ –æ–±—ä—è—Å–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, –∫–∞–∫ –∫–ª–µ–π–º–∏—Ç—å

---

## üéØ –°–ø–æ—Å–æ–± 2: Owner –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –±–∞—Ç—á–∞–º–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π (`batchSend()`)

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

```solidity
function batchSend(
    address[] calldata recipients,
    uint256[] calldata amounts,
    bytes32[][] calldata merkleProofs
) external onlyOwner {
    require(recipients.length <= 100, "Batch too large"); // DoS –∑–∞—â–∏—Ç–∞
    
    for (uint256 i = 0; i < recipients.length; i++) {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ Merkle proof –¥–ª—è –∫–∞–∂–¥–æ–≥–æ
        bytes32 leaf = keccak256(abi.encodePacked(recipients[i], amounts[i]));
        require(
            MerkleProof.verify(merkleProofs[i], merkleRoot, leaf),
            "Invalid Merkle proof"
        );
        
        // –û—Ç–º–µ—Ç–∏—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å
        claimed[recipients[i]] = true;
        IERC20(token).transfer(recipients[i], amounts[i]);
    }
}
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. Owner –±–µ—Ä–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ `merkle-tree-data.json`
2. –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –≤ –±–∞—Ç—á–∏ –ø–æ 100 –∞–¥—Ä–µ—Å–æ–≤
3. –í—ã–∑—ã–≤–∞–µ—Ç `batchSend(recipients, amounts, proofs)`
4. –ö–æ–Ω—Ç—Ä–∞–∫—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–∂–¥—ã–π proof
5. –¢–æ–∫–µ–Ω—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```javascript
// –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –±–∞—Ç—á–∞
const batch = recipients.slice(0, 100); // –ü–µ—Ä–≤—ã–µ 100

const addresses = batch.map(r => r.address);
const amounts = batch.map(r => r.amount);
const proofs = batch.map(r => r.proof);

// –í—ã–∑–æ–≤ —á–µ—Ä–µ–∑ Gnosis Safe
await airdrop.batchSend(addresses, amounts, proofs);
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ü—Ä–æ–∑—Ä–∞—á–Ω–æ (–ø—Ä–æ–≤–µ—Ä–∫–∞ Merkle proof)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (owner –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç)
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –ø–ª–∞—Ç—è—Ç –≥–∞–∑

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è Owner –ø–ª–∞—Ç–∏—Ç –≥–∞–∑
- ‚ö†Ô∏è –ù—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å —á–µ—Ä–µ–∑ Gnosis Safe (–º—É–ª—å—Ç–∏–ø–æ–¥–ø–∏—Å—å)

---

## üéØ –°–ø–æ—Å–æ–± 3: Owner –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ (`batchSendDirect()`)

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

```solidity
function batchSendDirect(
    address[] calldata recipients,
    uint256[] calldata amounts
) external onlyOwner {
    require(recipients.length <= 100, "Batch too large");
    
    for (uint256 i = 0; i < recipients.length; i++) {
        require(!claimed[recipients[i]], "Already sent");
        claimed[recipients[i]] = true;
        IERC20(token).transfer(recipients[i], amounts[i]);
    }
}
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. Owner –ø—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ–∫–µ–Ω—ã –ø–æ —Å–ø–∏—Å–∫—É
2. **–ë–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ Merkle proof**
3. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ï—Å–ª–∏ Merkle tree –Ω–µ –Ω—É–∂–µ–Ω –¥–ª—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏
- –ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –Ω–µ–±–æ–ª—å—à–æ–π –∏ –∏–∑–≤–µ—Å—Ç–µ–Ω

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ë—ã—Å—Ç—Ä–æ (–Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ proof)
- ‚úÖ –ú–µ–Ω—å—à–µ –≥–∞–∑–∞

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è –ù–µ—Ç –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏ (–Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ Merkle)
- ‚ö†Ô∏è –ú–µ–Ω–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ó–∞—â–∏—Ç–∞ –æ—Ç DoS
```solidity
require(recipients.length <= 100, "Batch too large");
```
- –ú–∞–∫—Å–∏–º—É–º 100 –∞–¥—Ä–µ—Å–æ–≤ –∑–∞ –æ–¥–∏–Ω –±–∞—Ç—á
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

### –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∫–ª–µ–π–º–∞
```solidity
mapping(address => bool) public claimed;
```
- –ö–∞–∂–¥—ã–π –∞–¥—Ä–µ—Å –º–æ–∂–µ—Ç –∫–ª–µ–π–º–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
- –ü—Ä–æ–≤–µ—Ä–∫–∞: `require(!claimed[msg.sender])`

### –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏
- Merkle proof –¥–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –∞–¥—Ä–µ—Å –≤ —Å–ø–∏—Å–∫–µ
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–¥–¥–µ–ª–∞—Ç—å proof –±–µ–∑ –∑–Ω–∞–Ω–∏—è Merkle root
- Merkle root –ø—É–±–ª–∏—á–µ–Ω, –Ω–æ proof —É–Ω–∏–∫–∞–ª–µ–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–¥—Ä–µ—Å–∞

---

## üìä –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–æ—Ñ—á–µ–π–Ω)

```bash
# CSV —Ñ–∞–π–ª
cat data/token-balances.csv
# address,amount
# 0x1234...,1000
# 0x5678...,2000

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Merkle Tree
node scripts/generate-merkle-tree.js data/token-balances.csv

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# ‚úÖ Merkle root: 0xabc123...
# ‚úÖ Saved to: merkle-tree-data.json
```

### 2. –î–µ–ø–ª–æ–π –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–æ–Ω—á–µ–π–Ω)

```javascript
// 1. –î–µ–ø–ª–æ–π
const airdrop = await Airdrop.deploy(tokenAddress);

// 2. –ü–µ—Ä–µ–≤–æ–¥ —Ç–æ–∫–µ–Ω–æ–≤
await savitriCoin.transfer(airdrop.address, totalAmount);

// 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ root
await airdrop.setMerkleRoot("0xabc123...");

// 4. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è
await airdrop.setClaimEndTime(endTime);
```

### 3. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (–≤—ã–±–æ—Ä —Å–ø–æ—Å–æ–±–∞)

**–í–∞—Ä–∏–∞–Ω—Ç A: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∫–ª–µ–π–º—è—Ç**
```javascript
// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–∑—ã–≤–∞–µ—Ç
await airdrop.claim(amount, proof);
```

**–í–∞—Ä–∏–∞–Ω—Ç B: Owner –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –±–∞—Ç—á–∞–º–∏**
```javascript
// Owner –≤—ã–∑—ã–≤–∞–µ—Ç —á–µ—Ä–µ–∑ Gnosis Safe
await airdrop.batchSend(recipients, amounts, proofs);
```

**–í–∞—Ä–∏–∞–Ω—Ç C: Owner –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–ø—Ä—è–º—É—é**
```javascript
// Owner –≤—ã–∑—ã–≤–∞–µ—Ç
await airdrop.batchSendDirect(recipients, amounts);
```

### 4. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ

```javascript
// –ü–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–µ—Ä–∏–æ–¥–∞ –∫–ª–µ–π–º–∞
await airdrop.withdrawUnclaimed(ownerAddress, unclaimedAmount);
```

---

## üéØ –ö–∞–∫–æ–π —Å–ø–æ—Å–æ–± –≤—ã–±—Ä–∞—Ç—å?

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `claim()` –µ—Å–ª–∏:
- ‚úÖ –•–æ—Ç–∏—Ç–µ –¥–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∞–∏—Ä–¥—Ä–æ–ø
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≥–æ—Ç–æ–≤—ã –ø–ª–∞—Ç–∏—Ç—å –≥–∞–∑
- ‚úÖ –ú–Ω–æ–≥–æ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π (—Ç—ã—Å—è—á–∏)

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `batchSend()` –µ—Å–ª–∏:
- ‚úÖ –•–æ—Ç–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—Ç–ø—Ä–∞–≤–∫—É
- ‚úÖ –ù—É–∂–Ω–∞ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å (Merkle proof)
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –ø–ª–∞—Ç–∏—Ç—å –≥–∞–∑
- ‚úÖ –ì–æ—Ç–æ–≤—ã –¥–µ–ª–∞—Ç—å —á–µ—Ä–µ–∑ Gnosis Safe

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `batchSendDirect()` –µ—Å–ª–∏:
- ‚úÖ –ù–µ–±–æ–ª—å—à–æ–π —Å–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π
- ‚úÖ Merkle tree –Ω–µ –Ω—É–∂–µ–Ω
- ‚úÖ –î–æ–≤–µ—Ä–µ–Ω–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

---

## üìù –†–µ–∑—é–º–µ

**Airdrop.sol** ‚Äî —ç—Ç–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç –¥–ª—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–≥–æ –∞–∏—Ä–¥—Ä–æ–ø–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Merkle Tree:

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Merkle Tree –∏–∑ CSV
2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞:** –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Merkle root –≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç
3. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** 3 —Å–ø–æ—Å–æ–±–∞ (claim, batchSend, batchSendDirect)
4. **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å:** Merkle root –ø—É–±–ª–∏—á–µ–Ω, –ª—é–±–æ–π –º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
5. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** DoS –∑–∞—â–∏—Ç–∞, –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∫–ª–µ–π–º–∞

**–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –í–µ—Å—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –æ—Ñ—á–µ–π–Ω, –≤ –±–ª–æ–∫—á–µ–π–Ω–µ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ö–µ—à (Merkle root), –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.


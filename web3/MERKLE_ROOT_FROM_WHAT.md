# –û—Ç–∫—É–¥–∞ –±–µ—Ä–µ—Ç—Å—è Merkle Root?

## üìã –ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏

**Merkle Root –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–∑ –≤–∞—à–µ–≥–æ CSV —Ñ–∞–π–ª–∞ —Å –∞–¥—Ä–µ—Å–∞–º–∏ –∏ —Å—É–º–º–∞–º–∏.**

---

## üîç –ü–æ—à–∞–≥–æ–≤–æ

### –®–∞–≥ 1: –£ –≤–∞—Å –µ—Å—Ç—å CSV —Ñ–∞–π–ª

```csv
address,amount
0x1234567890123456789012345678901234567890,1000
0x5678901234567890123456789012345678901234,2000
0x9abcdef0123456789012345678901234567890ab,500
```

**–≠—Ç–æ –≤–∞—à —Å–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π:**
- –ê–¥—Ä–µ—Å ‚Üí –°—É–º–º–∞ —Ç–æ–∫–µ–Ω–æ–≤

---

### –®–∞–≥ 2: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç–µ Merkle Root

**–ó–∞–ø—É—Å–∫–∞–µ—Ç–µ —Å–∫—Ä–∏–ø—Ç:**
```bash
node scripts/generate-merkle-tree.js data/token-balances.csv
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏:**

1. **–ß–∏—Ç–∞–µ—Ç—Å—è CSV —Ñ–∞–π–ª:**
   ```javascript
   recipients = [
     { address: "0x1234...", amount: "1000" },
     { address: "0x5678...", amount: "2000" },
     { address: "0x9abc...", amount: "500" }
   ]
   ```

2. **–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—É—á–∞—Ç–µ–ª—è —Å–æ–∑–¥–∞–µ—Ç—Å—è "–ª–∏—Å—Ç" (leaf):**
   ```javascript
   // –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–¥—Ä–µ—Å–∞:
   leaf = keccak256(address + amount)
   
   // –ü—Ä–∏–º–µ—Ä:
   leaf1 = keccak256("0x1234..." + "1000") = "0xabc123..."
   leaf2 = keccak256("0x5678..." + "2000") = "0xdef456..."
   leaf3 = keccak256("0x9abc..." + "500")  = "0x789abc..."
   ```

3. **–°—Ç—Ä–æ–∏—Ç—Å—è Merkle Tree –∏–∑ –ª–∏—Å—Ç—å–µ–≤:**
   ```
   –õ–∏—Å—Ç—å—è:
   leaf1 = "0xabc123..."
   leaf2 = "0xdef456..."
   leaf3 = "0x789abc..."
   
   Merkle Tree:
         root = "0xROOT123..."
            /              \
      node1 = "0x..."    node2 = "0x..."
        /      \            |
    leaf1    leaf2       leaf3
   ```

4. **–ü–æ–ª—É—á–∞–µ—Ç–µ Merkle Root:**
   ```
   Merkle Root = "0xROOT123..."
   ```

---

### –®–∞–≥ 3: –†–µ–∑—É–ª—å—Ç–∞—Ç

**–°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª—ã:**

1. **`merkle-tree-data.json`** ‚Äî –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
   ```json
   {
     "merkleRoot": "0xROOT123...",
     "totalRecipients": 3,
     "recipients": [
       {
         "address": "0x1234...",
         "amount": "1000",
         "proof": ["0xdef456...", "0x789abc..."]
       },
       {
         "address": "0x5678...",
         "amount": "2000",
         "proof": ["0xabc123...", "0x789abc..."]
       },
       {
         "address": "0x9abc...",
         "amount": "500",
         "proof": ["0xabc123...", "0xdef456..."]
       }
     ]
   }
   ```

2. **`merkle-root.json`** ‚Äî —Ç–æ–ª—å–∫–æ root:
   ```json
   {
     "merkleRoot": "0xROOT123...",
     "totalRecipients": 3,
     "totalAmount": "3500"
   }
   ```

---

## üîë –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### 1. Merkle Root –∑–∞–≤–∏—Å–∏—Ç –æ—Ç CSV —Ñ–∞–π–ª–∞

**–ï—Å–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å CSV ‚Üí Merkle Root –∏–∑–º–µ–Ω–∏—Ç—Å—è:**

```
CSV 1:
0x1234... ‚Üí 1000
Merkle Root = "0xABC..."

CSV 2 (–∏–∑–º–µ–Ω–∏–ª–∏ —Å—É–º–º—É):
0x1234... ‚Üí 2000
Merkle Root = "0xDEF..."  ‚Üê –î—Ä—É–≥–æ–π root!
```

**–í—ã–≤–æ–¥:** Merkle Root —É–Ω–∏–∫–∞–ª–µ–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ CSV —Ñ–∞–π–ª–∞.

---

### 2. –ü–æ—Ä—è–¥–æ–∫ –∞–¥—Ä–µ—Å–æ–≤ –Ω–µ –≤–∞–∂–µ–Ω

**Merkle Tree –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –ª–∏—Å—Ç—å—è:**
```
CSV 1:
0x1234... ‚Üí 1000
0x5678... ‚Üí 2000

CSV 2 (–ø–æ–º–µ–Ω—è–ª–∏ –ø–æ—Ä—è–¥–æ–∫):
0x5678... ‚Üí 2000
0x1234... ‚Üí 1000

Merkle Root = –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π! ‚úÖ
```

**–í—ã–≤–æ–¥:** –ü–æ—Ä—è–¥–æ–∫ —Å—Ç—Ä–æ–∫ –≤ CSV –Ω–µ –≤–∞–∂–µ–Ω.

---

### 3. –ï—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å/—É–¥–∞–ª–∏—Ç—å –∞–¥—Ä–µ—Å ‚Üí Root –∏–∑–º–µ–Ω–∏—Ç—Å—è

```
CSV 1 (3 –∞–¥—Ä–µ—Å–∞):
0x1234... ‚Üí 1000
0x5678... ‚Üí 2000
0x9abc... ‚Üí 500
Merkle Root = "0xABC..."

CSV 2 (–¥–æ–±–∞–≤–∏–ª–∏ –∞–¥—Ä–µ—Å):
0x1234... ‚Üí 1000
0x5678... ‚Üí 2000
0x9abc... ‚Üí 500
0xdef0... ‚Üí 300  ‚Üê –ù–æ–≤—ã–π –∞–¥—Ä–µ—Å
Merkle Root = "0xDEF..."  ‚Üê –î—Ä—É–≥–æ–π root!
```

**–í—ã–≤–æ–¥:** –õ—é–±–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ CSV ‚Üí –Ω–æ–≤—ã–π Merkle Root.

---

## üìù –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä

### –ü–æ–ª–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å:

**1. –£ –≤–∞—Å –µ—Å—Ç—å CSV:**
```csv
address,amount
0x1234...,1000
0x5678...,2000
```

**2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç–µ Merkle Tree:**
```bash
$ node scripts/generate-merkle-tree.js data/token-balances.csv

üìñ Reading CSV file: data/token-balances.csv
‚úÖ Found 2 recipients

üå≥ Generating Merkle tree...
‚úÖ Merkle root: 0xabc123def456789...

‚úÖ Full data saved to: merkle-tree-data.json
‚úÖ Summary saved to: merkle-root.json
```

**3. –°–º–æ—Ç—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```bash
$ cat merkle-root.json
{
  "merkleRoot": "0xabc123def456789...",
  "totalRecipients": 2,
  "totalAmount": "3000"
}
```

**4. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç–µ –≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç:**
```javascript
await airdrop.setMerkleRoot("0xabc123def456789...");
```

**5. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏:**
```javascript
// –ò–∑ merkle-tree-data.json –±–µ—Ä–µ—Ç–µ proofs
await airdrop.batchSend(
    ["0x1234...", "0x5678..."],
    [1000, 2000],
    [proof1, proof2]  // ‚Üê –ò–∑ merkle-tree-data.json
);
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ß—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç Merkle Root:

**1. –ù–µ–ª—å–∑—è –ø–æ–¥–¥–µ–ª–∞—Ç—å —Å—É–º–º—ã:**
```
CSV: 0x1234... ‚Üí 1000
Merkle Root: "0xABC..."

–ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å 2000 –≤–º–µ—Å—Ç–æ 1000:
‚Üí Proof –Ω–µ –ø—Ä–æ–π–¥–µ—Ç
‚Üí –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è
```

**2. –ù–µ–ª—å–∑—è –¥–æ–±–∞–≤–∏—Ç—å –ª–∏—à–Ω–∏–µ –∞–¥—Ä–µ—Å–∞:**
```
CSV: —Ç–æ–ª—å–∫–æ 0x1234... –∏ 0x5678...
Merkle Root: "0xABC..."

–ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å 0x9999... (–∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ CSV):
‚Üí Proof –Ω–µ –ø—Ä–æ–π–¥–µ—Ç
‚Üí –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è
```

**3. –ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å CSV –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è Root:**
```
–ï—Å–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å CSV ‚Üí Merkle Root –∏–∑–º–µ–Ω–∏—Ç—Å—è
–õ—é–¥–∏ —Å—Ä–∞–∑—É —É–≤–∏–¥—è—Ç –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ
```

---

## üìä –†–µ–∑—é–º–µ

**Merkle Root –±–µ—Ä–µ—Ç—Å—è –∏–∑:**
- ‚úÖ –í–∞—à–µ–≥–æ CSV —Ñ–∞–π–ª–∞ —Å –∞–¥—Ä–µ—Å–∞–º–∏ –∏ —Å—É–º–º–∞–º–∏
- ‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º `generate-merkle-tree.js`
- ‚úÖ –≠—Ç–æ "–æ—Ç–ø–µ—á–∞—Ç–æ–∫" –≤—Å–µ–≥–æ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. CSV —Ñ–∞–π–ª ‚Üí —Å–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π
2. –°–∫—Ä–∏–ø—Ç ‚Üí –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç Merkle Tree
3. –†–µ–∑—É–ª—å—Ç–∞—Ç ‚Üí Merkle Root + Proofs
4. Merkle Root ‚Üí —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç
5. Proofs ‚Üí –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ

**–í–∞–∂–Ω–æ:**
- Merkle Root —É–Ω–∏–∫–∞–ª–µ–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ CSV
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ CSV ‚Üí –Ω–æ–≤—ã–π Root
- –ü–æ—Ä—è–¥–æ–∫ —Å—Ç—Ä–æ–∫ –Ω–µ –≤–∞–∂–µ–Ω
- Root –ø—É–±–ª–∏—á–µ–Ω –≤ –±–ª–æ–∫—á–µ–π–Ω–µ

**–í—ã–≤–æ–¥:** Merkle Root = –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π "–æ—Ç–ø–µ—á–∞—Ç–æ–∫" –≤–∞—à–µ–≥–æ CSV —Ñ–∞–π–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Å—É–º–º –±–µ–∑ —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Å–µ–≥–æ —Å–ø–∏—Å–∫–∞ –≤ –±–ª–æ–∫—á–µ–π–Ω–µ.

